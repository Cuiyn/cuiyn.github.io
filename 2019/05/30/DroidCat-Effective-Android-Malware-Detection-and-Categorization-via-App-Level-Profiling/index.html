<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha256-/4UQcSmErDzPCMAiuOiWPVVsNN2s3ZY/NsmXNcj0IFc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"cuiyn.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.15.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="本文介绍2019年发表在IEEE Trans on Information Forensics and Security的一篇文章，题目是《DroidCat: Effective Android Malware Detection and Categorization via App-Level Profiling》，DOI信息在这里。 本文作者提出DroidCat，一个先进的动态App分类技术，">
<meta property="og:type" content="article">
<meta property="og:title" content="DroidCat：基于App层面的Android恶意软件检测与分类">
<meta property="og:url" content="http://cuiyn.github.io/2019/05/30/DroidCat-Effective-Android-Malware-Detection-and-Categorization-via-App-Level-Profiling/index.html">
<meta property="og:site_name" content="Cuiyn&#39;s Blog">
<meta property="og:description" content="本文介绍2019年发表在IEEE Trans on Information Forensics and Security的一篇文章，题目是《DroidCat: Effective Android Malware Detection and Categorization via App-Level Profiling》，DOI信息在这里。 本文作者提出DroidCat，一个先进的动态App分类技术，">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://cuiyn.github.io/statics/images/20190530/sample_code.png">
<meta property="og:image" content="http://cuiyn.github.io/statics/images/20190530/overview.png">
<meta property="og:image" content="http://cuiyn.github.io/statics/images/20190530/DroidCat.png">
<meta property="article:published_time" content="2019-05-29T22:10:00.000Z">
<meta property="article:modified_time" content="2023-03-22T14:12:31.188Z">
<meta property="article:author" content="Cuiyn">
<meta property="article:tag" content="论文">
<meta property="article:tag" content="恶意代码分析">
<meta property="article:tag" content="Android">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://cuiyn.github.io/statics/images/20190530/sample_code.png">


<link rel="canonical" href="http://cuiyn.github.io/2019/05/30/DroidCat-Effective-Android-Malware-Detection-and-Categorization-via-App-Level-Profiling/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://cuiyn.github.io/2019/05/30/DroidCat-Effective-Android-Malware-Detection-and-Categorization-via-App-Level-Profiling/","path":"2019/05/30/DroidCat-Effective-Android-Malware-Detection-and-Categorization-via-App-Level-Profiling/","title":"DroidCat：基于App层面的Android恶意软件检测与分类"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>DroidCat：基于App层面的Android恶意软件检测与分类 | Cuiyn's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Cuiyn's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%91%98%E8%A6%81"><span class="nav-number">1.</span> <span class="nav-text">摘要</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%BF%80%E5%8A%B1%E6%80%A7%E7%A4%BA%E4%BE%8B"><span class="nav-number">2.</span> <span class="nav-text">激励性示例</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%83%8C%E6%99%AF"><span class="nav-number">3.</span> <span class="nav-text">背景</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Android-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="nav-number">3.1.</span> <span class="nav-text">Android 应用程序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICC"><span class="nav-number">3.2.</span> <span class="nav-text">ICC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%96%B9%E6%B3%95%E4%B8%8E%E5%9B%9E%E8%B0%83"><span class="nav-number">3.3.</span> <span class="nav-text">生命周期方法与回调</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E7%9B%B8%E5%85%B3API"><span class="nav-number">3.4.</span> <span class="nav-text">安全相关API</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%89%B9%E5%BE%81%E5%8F%91%E7%8E%B0%E4%B8%8E%E8%AE%A1%E7%AE%97"><span class="nav-number">4.</span> <span class="nav-text">特征发现与计算</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A1%E9%87%8F%E5%9F%BA%E5%87%86"><span class="nav-number">4.1.</span> <span class="nav-text">衡量基准</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E6%A0%87%E5%AE%9A%E4%B9%89"><span class="nav-number">4.2.</span> <span class="nav-text">指标定义</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E7%BB%B4%E5%BA%A6"><span class="nav-number">4.2.1.</span> <span class="nav-text">结构维度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ICC%E7%BB%B4%E5%BA%A6"><span class="nav-number">4.2.2.</span> <span class="nav-text">ICC维度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E7%BB%B4%E5%BA%A6"><span class="nav-number">4.2.3.</span> <span class="nav-text">安全维度</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E6%A0%87%EF%BC%88%E7%89%B9%E5%BE%81%EF%BC%89%E8%AE%A1%E7%AE%97"><span class="nav-number">4.3.</span> <span class="nav-text">指标（特征）计算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E6%A0%87%EF%BC%88%E7%89%B9%E5%BE%81%EF%BC%89%E9%80%89%E6%8B%A9"><span class="nav-number">4.4.</span> <span class="nav-text">指标（特征）选择</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DroidCat%E6%96%B9%E6%B3%95"><span class="nav-number">5.</span> <span class="nav-text">DroidCat方法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E7%AB%A0%E7%BB%93%E6%9E%84%E5%9B%BE"><span class="nav-number">6.</span> <span class="nav-text">文章结构图</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%93%E8%AF%AD"><span class="nav-number">7.</span> <span class="nav-text">结语</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Cuiyn</p>
  <div class="site-description" itemprop="description">关注计算机安全文献与计算机领域热门话题</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">39</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://cuiyn.github.io/2019/05/30/DroidCat-Effective-Android-Malware-Detection-and-Categorization-via-App-Level-Profiling/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cuiyn">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cuiyn's Blog">
      <meta itemprop="description" content="关注计算机安全文献与计算机领域热门话题">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="DroidCat：基于App层面的Android恶意软件检测与分类 | Cuiyn's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          DroidCat：基于App层面的Android恶意软件检测与分类
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-05-30 06:10:00" itemprop="dateCreated datePublished" datetime="2019-05-30T06:10:00+08:00">2019-05-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-22 22:12:31" itemprop="dateModified" datetime="2023-03-22T22:12:31+08:00">2023-03-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>本文介绍2019年发表在<em>IEEE Trans on Information Forensics and Security</em>的一篇文章，题目是《DroidCat: Effective Android Malware Detection and Categorization via App-Level Profiling》，DOI信息在<a target="_blank" rel="noopener" href="https://doi.org/10.1109/TIFS.2018.2879302">这里</a>。</p>
<p>本文作者提出DroidCat，一个先进的动态App分类技术，以对现有的方法进行补充。DroidCat在不涉及权限、App资源或系统调用的情况下，能够完美地处理应用代码中的反射（reflection）。使用基于方法调用和组件间通信（inter-component communication，ICC）Intent的各种动态特性，实现了比依赖于系统调用的静态方法和动态方法更好的鲁棒性。</p>
<span id="more"></span>

<h1 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h1><p>Android已经成为97%移动恶意软件的目标平台，这些恶意软件偷窃个人信息、滥用特权资源，或者安装其它恶意软件。随着Android市场的快速增长，区分恶意软件和良性App非常重要（即，进行恶意软件检测）。此外，对于威胁评估和防御规划，区分不同种类的恶意软件（即，按家族划分的恶意软件分类）同样重要。</p>
<p>研究领域主要有两类Android恶意软件检测&#x2F;分类的方法：静态和动态。静态方法利用静态代码分析来检查App是否包含异常信息流或调用结构、是否匹配恶意代码模式、是否请求过多的权限，与&#x2F;或调用恶意软件经常调用的API。静态方法的优点是可靠和可扩展的，可用于筛选大量App，但它们不能总是精确地检测恶意软件，原因有三。</p>
<ul>
<li>首先，由于Android的事件驱动特性（例如生命周期回调和GUI处理），运行时控制&#x2F;数据流并不总是静态可估计的。它们依赖于运行时环境。这使得静态分析无法揭示许多恶意软件活动。</li>
<li>其次，代码中存在的一些权限和&#x2F;或API并不总是意味着它们实际上在运行时经常被执行或调用，从而导致攻击。纯粹检查权限和&#x2F;或API的存在可能导致静态分析错误地报告恶意软件。特别是在API级别23之后，Android增加了动态权限支持，这样App可以在运行时请求、获取和撤销权限。这种新的运行时权限机制意味着静态方法无法在运行时发现异常权限何时被请求和授予。</li>
<li>最后，静态方法在检测通过动态代码构造（例如，通过反射调用敏感API）执行的恶意行为方面能力有限。这些限制使得静态分析容易受到广泛采用的探测规避方案（如代码混淆和变形）的影响。</li>
</ul>
<p>相比之下，动态方法提供了一种互补的方法来检测和分类恶意软件。机器学习已经越来越多地融入到这些技术中，从这些特征中训练分类模型来区分恶意和良性App。但是，当App混淆使用系统调用时，仍然可以逃避基于系统调用的恶意软件检测器。敏感的API使用并不一定表示恶意意图，异常的资源使用也并不总是对应于异常的行为。通常，依赖于系统调用序列和&#x2F;或依赖关系的、基于行为的方法可能很容易被系统调用混淆技术（例如，模仿攻击和错觉）击败。因此，需要一个更全面的动态App分类器来捕获不同的行为概要文件，从而对针对特定特征的攻击具有鲁棒性。</p>
<p>在本文中，作者开发了一种新的App分类技术──DroidCat，基于App层面与监督学习。DroidCat的开发不仅可以检测Android恶意软件，还可以有效地对Android恶意软件进行分类（分别称为恶意软件检测和恶意软件分类）。与现有的基于学习的动态方法不同，DroidCat基于多样的App行为概要来训练它的分类模型，其中包含一些功能，这些功能涵盖了运行时App的互补。DroidCat概要描述组件间通信（ICC）调用和所有方法的调用，包括由用户代码、第三方库和Android框架定义的方法（而不是监视系统调用）。此外，它完全能够处理反射，而不使用基于App资源或每个任务的功能。因此，DroidCat对于针对系统调用或利用反射的攻击非常健壮。DroidCat对于针对特定敏感API的攻击也很健壮，因为它们不是方法调用的唯一目标。</p>
<p>DroidCat中使用的特征是基于136个良性和135个恶意App的动态特性研究确定的。在研究中，作者追踪了每一个App的执行情况，定义并评估了122个行为指标，以彻底描述两组App之间的行为差异。评估结果显示，DroidCat具有很高的稳定性：在恶意软件检测和分类方面，DroidCat分别实现了97.4%和97.8%的F1精度。</p>
<p>综上所述，文章做出了以下贡献：</p>
<ul>
<li><p>开发了DroidCat，这是一种新颖的Android App分类方法，基于一组崭新的、多样化的功能，这些功能通过简短的App层概要，在运行时捕获App行为。这些特征是通过一项动态特性研究发现的，该研究揭示了良性和恶意App在方法上的行为差异。</p>
</li>
<li><p>通过三项补充研究对DroidCat进行了评估。在2009年至2017年期间，对34,343个不同的App采用了两种最先进的同类方法作为基准。结果表明，DroidCat在稳定性、分类性能和鲁棒性方面都优于基线，在效率上具有较好竞争力。</p>
</li>
<li><p>对DroidCat进行了深入的案例研究，研究其对单个恶意软件家族的性能以及影响其分类能力的各种因素。文章的研究结果证实了DroidCat始终保持着较高的整体性能，并且在文章调查的大多数家族中都显示出了其强大的性能。文章还确定了DroidCat最有效的学习算法和动态特性，并证明了DroidCat对动态输入覆盖率的低敏感性。</p>
</li>
</ul>
<h1 id="激励性示例"><a href="#激励性示例" class="headerlink" title="激励性示例"></a>激励性示例</h1><p>下图是5个来自于真实木马病毒家族<em>FakeInst</em>样本的代码片段，此家族的样本向收费号码发送短信。可以看出，除第3行的数据加密之外，这个恶意软件大量使用反射，以调用包括Android API在内的方法，以便访问设备ID等特权资源（第1-11行）。此外，为了利用SMS服务（第13-18行），它通过反射（第27-29行）得到恶意消息传递所需的文本和号码，然后调用<em>sendSms</em>（第30行），后者再次通过反射调用<em>ad.notify.SmsItem::send</em>（第20-23行）。</p>
<p><img src="/statics/images/20190530/sample_code.png" alt="FakeInst样本代码片段示意图" title="FakeInst样本代码片段示意图"></p>
<p>虽然使用字符串常量的简单反射（例如，第22、27、28行）可以通过静态分析以额外的代价消除混淆，但是更复杂的情况可能不会（例如，第4、5、15、16行，其中类名和方法名从数据库对象<em>mdb</em>中检索）。因此，与API和敏感流相关的、基于静态代码的特性将不会从App中提取，基于这些特性的技术也不会检测到安全威胁。此外，该样本中的恶意行为只显示在其代码中，而不反映在其resource&#x2F;asset文件中（如配置和UI布局）；因此，绕过代码分析的方法可能也不会成功。此外，恶意软件开发者也很容易混淆App资源。在这些情况下，作者认为健壮的动态方法是抵御此类恶意软件样本的必要补充。</p>
<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><h2 id="Android-应用程序"><a href="#Android-应用程序" class="headerlink" title="Android 应用程序"></a>Android 应用程序</h2><p>程序员主要使用Java开发Android App，之后将它们构建为App包文件（即APK）。每个APK文件可以包含3个软件层：用户代码、Android库与第三方库。Android App通常由4大组件构成：<em>Activitiy</em>处理UI与用户与显示屏的交互，<em>Service</em>处理与App相关的后台进程，<em>Broadcast Receiver</em>处理App与Android系统的交互，<em>Content Provider</em>处理数据存储与管理的问题。</p>
<h2 id="ICC"><a href="#ICC" class="headerlink" title="ICC"></a>ICC</h2><p>组件（多数是<em>Intent</em>）通过ICC对象互相交互。如果发送者与接收者均为同一个App的Intent，则将这个ICC归类为<strong>内部的</strong>，否则为<strong>外部的</strong>。如果一个Intent在其内容中明确指定了接收者，则将ICC归类为<strong>明确的</strong>，否则为<strong>隐式的</strong>。</p>
<h2 id="生命周期方法与回调"><a href="#生命周期方法与回调" class="headerlink" title="生命周期方法与回调"></a>生命周期方法与回调</h2><p>每个App组件都遵循一个规定的生命周期，该生命周期定义了如何创建、使用和销毁该组件。相应地，开发人员可以重写多个生命周期方法（例如，**onCreate()<strong>、</strong>onStart()<strong>和</strong>onDestroy()<strong>）来定义事件发生时的程序行为。开发人员还可以重写其他事件处理程序（例如</strong>onClick()**），或者定义新的回调函数，以便在发生事件时实现额外的逻辑。</p>
<h2 id="安全相关API"><a href="#安全相关API" class="headerlink" title="安全相关API"></a>安全相关API</h2><p>有一些敏感的API可以获取用户的个人信息，比如位置和联系人。例如，<strong>Location.getLatitility()<strong>和</strong>Location.getLongitude()<strong>检索GPS位置坐标。作者认为这些API是潜在敏感信息流的</strong>来源</strong>（source）。还有一些输出API通过网络或存储从当前组件发送数据，作者认为它们是潜在敏感信息流的<strong>接收点</strong>（sink）。如果App的执行轨迹具有从来源到接收点的任何路径，由于敏感数据可能泄漏，这个App可能是恶意的。</p>
<h1 id="特征发现与计算"><a href="#特征发现与计算" class="headerlink" title="特征发现与计算"></a>特征发现与计算</h1><p>来自于App执行轨迹的特征是文章方法的核心。从轨迹中可以提取许多特征，但不是所有特征都是一个好的分类标准。文章首先从一个相对较小的数据集（136个良性样本与135个恶意样本）里面，定义并测量了122个指标作为可能的特征，进行了系统的动态特性研究。通过对两组App的比较，确定了哪些指标是好的差异化因素，并将其纳入的特征集。这项探索性研究的中心目标是为DroidCat寻找使用的特征。</p>
<h2 id="衡量基准"><a href="#衡量基准" class="headerlink" title="衡量基准"></a>衡量基准</h2><p>文章提出了三条标准：</p>
<ol>
<li>最低支持的SDK版本为4.4（即API 19）或以上；</li>
<li>待测试的APK文件能够在Monkey的输入下成功运行；</li>
<li>App在Monkey的输入控制下，能够覆盖运行50%的用户代码。作者使用了DroidFax，它包括一个直接与APK一起工作的代码语句覆盖率度量工具，能够使用用户代码中的每个语句来跟踪运行时的覆盖率。</li>
</ol>
<p>对于带有良性标签的样本，从样本池中随机选择一个App，并判断其是否满足以上三条标准。如果满足，则将其提交至VirusTotal以进一步确认其为良性。对于恶意样本，文章从MalGenome数据集中找到了135个符合上述条件的App，并同样提交至VirusTotal确认其为恶意样本。</p>
<h2 id="指标定义"><a href="#指标定义" class="headerlink" title="指标定义"></a>指标定义</h2><p>基于收集到的执行轨迹，文章通过定义<strong>结构</strong>（structure）、<strong>ICC</strong>和<strong>安全性</strong>（security）这三个正交维度上的122个指标来表征App行为。直观地看，这些指标捕捉到的App行为越多，它们对App行为的表征就越完整。这些指标不仅度量特定方法调用或ICC的存在性，而且度量它们的相对出现频率和分布。</p>
<h3 id="结构维度"><a href="#结构维度" class="headerlink" title="结构维度"></a>结构维度</h3><p>包含关于方法调用的分布、它们的声明类与调用者-被调用者链接的63个指标。其中31个指标描述了所有方法调用在三个代码层（即用户代码、第三方库和Android SDK）或不同组件之间的分布。其他32个指标描述了一种特定方法的分布—回调（callback，包括生命周期方法和事件处理程序）。</p>
<h3 id="ICC维度"><a href="#ICC维度" class="headerlink" title="ICC维度"></a>ICC维度</h3><p>包含7个指标，用于描述ICC分布。由于有两种方法分类ICC（内部与外部、明确与隐式），列举所有可能的组合可以得到4个指标。其它3个指标依赖于与ICC关联的Intent数据定义：Intent包含的数据仅有URI或extras字段，或二者全部包含。</p>
<h3 id="安全维度"><a href="#安全维度" class="headerlink" title="安全维度"></a>安全维度</h3><p>包含52个指标，用于描述来源、接收点的分布以及它们之间通过方法级控制流的可达性。可达性用于区分所有有风险的来源&#x2F;接收点。如果一个来源到达至少一个接收器，它就被认为是一个危险的来源。类似地，有风险的接收器可以从至少一个来源访问。这两种情况都表明存在安全漏洞，因为敏感数据在从来源流向接收点的过程中可能会泄漏。</p>
<h2 id="指标（特征）计算"><a href="#指标（特征）计算" class="headerlink" title="指标（特征）计算"></a>指标（特征）计算</h2><p>为计算Android App的122个指标，文章使用Soot将每个App的APK文件与Android SDK库一起转化为Jimple代码（Soot的中间代码表示形式），之后在Jimple代码中插入探针，以在运行时层面监控每个方法调用（包括针对SDK API和第三方库函数的调用）与每个ICC Intent的轨迹。此外，还为类和方法标记了附加信息，以方便度量计算。例如，文章标记了每个检测类的组件类型、每个检测回调的类别以及每个相关SDK API的来源或接收点属性。</p>
<p>为确定一个类的组件类型，使用<strong>类等级分析</strong>（Class Hierarchy Analysis，CHA）识别所有父类。如果某个类继承自四大组件类型如<em>Activity</em>，则其组件类型标签就确定为这一类型。文章使用<em>DroidFax</em>中的方法类型映射列表来标记回调的类别和API的来源&#x2F;接收点属性。</p>
<p>异常处理和反射是两种广泛使用的Java构造。因此，文中的检测完全跟踪两种特殊类型的方法和ICC调用：通过反射发出的方法和由于异常控制流（例如，来自<em>catch</em>代码块和<em>finally</em>代码块的调用）而产生的方法和ICC调用。</p>
<p>之后，在Android模拟器上运行每个App的APK来收集执行轨迹，其中包括所有方法调用和执行的ICC。注意文章没有监视OS级别的系统调用，因为作者希望DroidCat对任何针对系统调用的攻击都具有健壮性。同样，这一方法也没有限制于敏感API。之前的工作表明，即使没有使用恶意系统调用或敏感API，一些恶意App仍然可以通过ICC操纵其他App进行攻击。因此需要跟踪ICC，进一步揭示良性和恶意App之间的行为差异。</p>
<p>为了描述App的动态行为，我们需要运行每个App足够长的时间，使用各种输入来覆盖尽可能多的程序路径。手工输入App的输入非常低效。为了快速触发App的不同执行轨迹，我们使用Monkey随机生成输入。为了平衡效率和代码覆盖率，我们将Monkey设置为每个App10分钟。一旦运行时监视器收集到App的轨迹，122个指标中的大多数可以直接通过轨迹跟踪统计数据计算出来。涉及到风险来源&#x2F;接收点的度量是通过构建的动态调用图计算的，以便于可达性计算。</p>
<h2 id="指标（特征）选择"><a href="#指标（特征）选择" class="headerlink" title="指标（特征）选择"></a>指标（特征）选择</h2><p>为了找出两组App之间有明显差别的度量标准，文章测量了每个基准App上的每个指标，然后分别计算了所有良性和恶意基准的平均值。如果一个指标的平均值差异大于或等于5%，则认为这两组的行为特征与该指标有<strong>很大不同</strong>（substantially disparate）。如果一个指标的差异大于或等于2%，则认为这两组的行为特征与该指标<strong>明显不同</strong>（noticeably different）。作者启发式地选择各种阈值进行了实验，发现这两个阈值（5%和2%）相当好地代表了恶意和良性样本之间的两个主要区分级别。</p>
<p>从结构（structure）、ICC和安全性（security）三个维度，文章提出了三点观察结果：</p>
<ol>
<li>恶意软件倾向于更多地从用户代码或第三方库调用SDK API，并定义更多的UI回调，这说明用户在这些API上的操作可能会触发过多&#x2F;意外的计算。</li>
<li>恶意软件可能使用更显式的ICC来攻击特定的外部组件，或者更频繁地通过ICC传播潜在的恶意URI。</li>
<li>恶意App比良性App表现出更少的日志记录操作。它们执行更危险的源代码，这可能导致敏感数据的泄漏。</li>
</ol>
<h1 id="DroidCat方法"><a href="#DroidCat方法" class="headerlink" title="DroidCat方法"></a>DroidCat方法</h1><p>基于上述特性研究，作者开发了DroidCat，一种利用系统分析和监督学习的App分类方法，来判断给定的App是良性的还是属于特定的恶意软件家族。如下图所示，我们的方法分为两个阶段:培训和测试。在培训方面，DroidCat将良性和恶意App都作为输入。对于每个App，它都将上述70个指标作为行为特性计算。然后利用这些特征，利用随机森林算法训练监督机器学习的多类分类器。对于测试阶段，给定一个任意的App，DroidCat计算相同的行为特性集，然后将这些特性提供给分类器，以确定该App是良性的还是恶意软件家族的成员。</p>
<p><img src="/statics/images/20190530/overview.png" alt="DroidCat概览图" title="DroidCat概览图"></p>
<p>作者使用Python的Scikit-learn工具实现DroidCat的学习部分，并将整个DroidCat系统与数据集开源。</p>
<h1 id="文章结构图"><a href="#文章结构图" class="headerlink" title="文章结构图"></a>文章结构图</h1><p><img src="/statics/images/20190530/DroidCat.png" alt="文章思维导图" title="文章思维导图"></p>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>本文方法新颖，叙述严密，且有充分的调研工作支撑，是一篇优秀的Android动态检测论文，非常值得学习。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E8%AE%BA%E6%96%87/" rel="tag"># 论文</a>
              <a href="/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/" rel="tag"># 恶意代码分析</a>
              <a href="/tags/Android/" rel="tag"># Android</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019/03/04/A-Novel-Dynamic-Android-Malware-Detection-System-With-Ensemble-Learning/" rel="prev" title="基于集成学习的Android恶意软件动态检测系统">
                  <i class="fa fa-chevron-left"></i> 基于集成学习的Android恶意软件动态检测系统
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/02/21/DeepIntent-Deep-Icon-Behavior-Learning-for-Detecting-Intention-Behavior-Discrepancy-in-Mobile-Apps/" rel="next" title="DeepIntent：用于移动APP意图-行为差异检测的深度图标-行为学习">
                  DeepIntent：用于移动APP意图-行为差异检测的深度图标-行为学习 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Cuiyn</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
